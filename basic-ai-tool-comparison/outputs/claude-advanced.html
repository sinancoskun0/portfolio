<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Text Helix Visualizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            color: #fff;
            overflow: hidden;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
        }

        #controls {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.9);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 100;
            min-width: 400px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #aaa;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #4a9eff;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: #333;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #4a9eff;
            cursor: pointer;
            border-radius: 50%;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #4a9eff;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .slider-value {
            display: inline-block;
            float: right;
            color: #4a9eff;
            font-weight: bold;
        }

        .color-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .color-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
        }

        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        input[type="color"]::-webkit-color-swatch {
            border: 2px solid #333;
            border-radius: 6px;
        }

        .color-label {
            font-size: 13px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div id="controls">
        <div class="control-group">
            <label for="text-input">Text Input</label>
            <input type="text" id="text-input" value="HELLO WORLD" placeholder="Enter text...">
        </div>

        <div class="control-group">
            <label for="rotation-speed">
                Rotation Speed
                <span class="slider-value" id="speed-value">0.5</span>
            </label>
            <input type="range" id="rotation-speed" min="0" max="2" step="0.1" value="0.5">
        </div>

        <div class="control-group">
            <label for="helix-radius">
                Helix Radius
                <span class="slider-value" id="radius-value">100</span>
            </label>
            <input type="range" id="helix-radius" min="50" max="200" step="5" value="100">
        </div>

        <div class="control-group">
            <label>Strand Colors</label>
            <div class="color-controls">
                <div class="color-group">
                    <input type="color" id="color-a" value="#00ff88">
                    <span class="color-label">Strand A</span>
                </div>
                <div class="color-group">
                    <input type="color" id="color-b" value="#ff0088">
                    <span class="color-label">Strand B</span>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // ============================================
        // Scene Setup
        // ============================================
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a0a);

        const camera = new THREE.PerspectiveCamera(
            60,
            window.innerWidth / window.innerHeight,
            0.1,
            2000
        );
        camera.position.set(0, 0, 400);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // ============================================
        // Lighting
        // ============================================
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(0, 200, 100);
        scene.add(directionalLight);

        // ============================================
        // Controls
        // ============================================
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.minDistance = 200;
        controls.maxDistance = 800;

        // ============================================
        // Helix Parameters
        // ============================================
        let helixRadius = 100;
        let rotationSpeed = 0.5;
        let strandAColor = new THREE.Color(0x00ff88);
        let strandBColor = new THREE.Color(0xff0088);

        const helixHeight = 300;
        const helixRotations = 3;
        const helixGroup = new THREE.Group();
        scene.add(helixGroup);

        // ============================================
        // Text Sprite Creation
        // ============================================
        function createTextSprite(character, color) {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const fontSize = 56; // Higher resolution for better quality
            canvas.width = 64;
            canvas.height = 64;

            context.font = `bold ${fontSize}px Arial`;
            context.fillStyle = color;
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            context.fillText(character, 32, 32);

            const texture = new THREE.CanvasTexture(canvas);
            texture.needsUpdate = true;

            const spriteMaterial = new THREE.SpriteMaterial({ 
                map: texture,
                transparent: true,
                depthTest: true,
                depthWrite: false
            });
            
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.scale.set(20, 20, 1);
            
            return sprite;
        }

        // ============================================
        // Helix Creation
        // ============================================
        function createHelix(text) {
            // Clear existing helix
            while(helixGroup.children.length > 0) {
                const child = helixGroup.children[0];
                if (child.geometry) child.geometry.dispose();
                if (child.material) {
                    if (child.material.map) child.material.map.dispose();
                    child.material.dispose();
                }
                helixGroup.remove(child);
            }

            if (!text) return;

            // Split text into two strands
            const strandA = [];
            const strandB = [];
            
            for (let i = 0; i < text.length; i++) {
                if (i % 2 === 0) {
                    strandA.push(text[i]);
                } else {
                    strandB.push(text[i]);
                }
            }

            // Create strand A (odd indices - 0, 2, 4...)
            const strandAPoints = [];
            strandA.forEach((char, i) => {
                const t = i / Math.max(strandA.length - 1, 1);
                const angle = t * Math.PI * 2 * helixRotations;
                const y = t * helixHeight - helixHeight / 2;
                const x = Math.cos(angle) * helixRadius;
                const z = Math.sin(angle) * helixRadius;

                const sprite = createTextSprite(char, strandAColor.getStyle());
                sprite.position.set(x, y, z);
                helixGroup.add(sprite);

                strandAPoints.push(new THREE.Vector3(x, y, z));
            });

            // Create strand B (even indices - 1, 3, 5...)
            const strandBPoints = [];
            strandB.forEach((char, i) => {
                const t = i / Math.max(strandB.length - 1, 1);
                const angle = t * Math.PI * 2 * helixRotations + Math.PI; // 180Â° offset
                const y = t * helixHeight - helixHeight / 2;
                const x = Math.cos(angle) * helixRadius;
                const z = Math.sin(angle) * helixRadius;

                const sprite = createTextSprite(char, strandBColor.getStyle());
                sprite.position.set(x, y, z);
                helixGroup.add(sprite);

                strandBPoints.push(new THREE.Vector3(x, y, z));
            });

            // Create connecting lines for strand A
            if (strandAPoints.length > 1) {
                const geometryA = new THREE.BufferGeometry().setFromPoints(strandAPoints);
                const materialA = new THREE.LineBasicMaterial({ 
                    color: strandAColor,
                    transparent: true,
                    opacity: 0.6
                });
                const lineA = new THREE.Line(geometryA, materialA);
                helixGroup.add(lineA);
            }

            // Create connecting lines for strand B
            if (strandBPoints.length > 1) {
                const geometryB = new THREE.BufferGeometry().setFromPoints(strandBPoints);
                const materialB = new THREE.LineBasicMaterial({ 
                    color: strandBColor,
                    transparent: true,
                    opacity: 0.6
                });
                const lineB = new THREE.Line(geometryB, materialB);
                helixGroup.add(lineB);
            }
        }

        // ============================================
        // UI Event Listeners
        // ============================================
        const textInput = document.getElementById('text-input');
        const rotationSpeedSlider = document.getElementById('rotation-speed');
        const helixRadiusSlider = document.getElementById('helix-radius');
        const colorAPicker = document.getElementById('color-a');
        const colorBPicker = document.getElementById('color-b');

        textInput.addEventListener('input', (e) => {
            createHelix(e.target.value);
        });

        rotationSpeedSlider.addEventListener('input', (e) => {
            rotationSpeed = parseFloat(e.target.value);
            document.getElementById('speed-value').textContent = rotationSpeed.toFixed(1);
        });

        helixRadiusSlider.addEventListener('input', (e) => {
            helixRadius = parseFloat(e.target.value);
            document.getElementById('radius-value').textContent = helixRadius;
            createHelix(textInput.value);
        });

        colorAPicker.addEventListener('input', (e) => {
            strandAColor = new THREE.Color(e.target.value);
            createHelix(textInput.value);
        });

        colorBPicker.addEventListener('input', (e) => {
            strandBColor = new THREE.Color(e.target.value);
            createHelix(textInput.value);
        });

        // ============================================
        // Responsive Canvas
        // ============================================
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // ============================================
        // Animation Loop
        // ============================================
        function animate() {
            requestAnimationFrame(animate);

            // Auto-rotation on Y axis
            helixGroup.rotation.y += rotationSpeed * 0.01;

            // Update controls
            controls.update();

            // Render scene
            renderer.render(scene, camera);
        }

        // ============================================
        // Initialize
        // ============================================
        createHelix(textInput.value);
        animate();
    </script>
</body>
</html>
